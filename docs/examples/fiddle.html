CTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <title>Fiddle</title>

        <link rel="stylesheet" href="https://rawgithub.com/yesmeck/jquery-jsonview/master/dist/jquery.jsonview.css" />

        <script type="text/javascript" src="http://code.jquery.com/jquery.min.js"></script>
        <script src="https://code.jquery.com/jquery-2.1.3.min.js" type="text/javascript"></script>
        <script type="text/javascript" src="https://rawgithub.com/yesmeck/jquery-jsonview/master/dist/jquery.jsonview.js"></script>
        <script src="https://www.dropbox.com/s/l6hgjq7mh52o6od/spiceworks-sdk.js?dl=1&raw=1" type="text/javascript"></script>

        <style type="text/css">

            #left { position: absolute; left: 0; top: 0; width: 50%; height: 50%; font-family: "Inconsolata";}

            #out { position: absolute; right: 0; top: 0; width: 50%; overflow-y: auto; height: 55%; color: #F6A605}

            #run { width: 100%; }

            #clear { width: 100%; }

            #in { display: block; left: 0; width: 100%; height: 100%; background-color: #D8D8D8; color: #19425F; vertical-align: top; padding: 0;}

        </style>

    </head>

    <body>
        <div id="left">
            <button id="clear">Clear Output</button>
            <button id="run">Run</button>
            <textarea id="in" tabindex="0"></textarea>
        </div>

        <div id="out"></div>
    </body>


    <script type="text/javascript">

        $( "#run" ).click(function() {
            processCommand();
        });

        $( "#clear" ).click(function() {
            clear();
        });

        index = 0;
        var e = new Evaluator();

        function Evaluator() {
            this.env = {};
        }

        Evaluator.prototype.evaluate = function (str) {
            try {
                var __environment__ = this.env;
                with (__environment__) {
                    return eval(str);
                }
            } catch (e) {
                return log(e.toString());
            }
        };

        function processCommand() {
            e.evaluate($('#in').val());
        }

        function clear() {
            // Delete div and that will delete all entries
            $("#out").remove();

            // Make sure to recreate it so next commands can get logged
            $("<div></div>").attr('id', "out").appendTo('body');
        }

        function log(text) {
            $("#out").append("<p>=> " + text + "</p>");
        }

        function outputJSON(json) {

            var divID = 'jsonView_';
            divID = divID.concat(index);

            $(function() {
                $("<div></div>").attr('id', divID).appendTo('#out');
                var divIDHash = '#';
                divIDHash = divIDHash.concat(divID);
                $(divIDHash).JSONView(json);
            });

            index++;

        }

    </script>

</html>

